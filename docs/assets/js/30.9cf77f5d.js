(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{280:function(e,t,r){"use strict";r.r(t);var a=r(28),s=Object(a.a)({},(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[r("h1",{attrs:{id:"webview问题集锦"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#webview问题集锦"}},[e._v("#")]),e._v(" webview问题集锦")]),e._v(" "),r("h3",{attrs:{id:"微信登陆后，如何把身份传给h5"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#微信登陆后，如何把身份传给h5"}},[e._v("#")]),e._v(" 微信登陆后，如何把身份传给h5")]),e._v(" "),r("p",[e._v("方案：这个问题比较简单，在webview的url字符串上传递就是了。迅速解决，这种feel很nice啊\n但要注意，当小程序从后台模式切换到前台模式时，在onshow里要进行身份的有效性检查")]),e._v(" "),r("h3",{attrs:{id:"小程序cookie和微信共享，切到后台不丢失"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#小程序cookie和微信共享，切到后台不丢失"}},[e._v("#")]),e._v(" 小程序cookie和微信共享，切到后台不丢失")]),e._v(" "),r("p",[e._v("问题："),r("br"),e._v("\n第一个页面开发完和后台接口联调的时候，突然发现token有问题（为了前后交互安全，基于OAuth实现的令牌）。")]),e._v(" "),r("p",[e._v("我们的h5网站也是可以微信浏览器访问的，但发放的token和小程序的是有差异性的。反反复复折腾了两天，才知道小程序的cookie和微信共享，而且后台运行时依然保留。\n方案：进入时判断是否小程序，是的话全部清理token，重新获取，保证cookie数据的一致性")]),e._v(" "),r("h3",{attrs:{id:"判断是否小程序内运行"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#判断是否小程序内运行"}},[e._v("#")]),e._v(" 判断是否小程序内运行")]),e._v(" "),r("p",[e._v("方案：小程序webview的url加个参数&isSP=true，程序里判断一把就ok了。绿色环保无污染")]),e._v(" "),r("h3",{attrs:{id:"高德地图的优化加载"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#高德地图的优化加载"}},[e._v("#")]),e._v(" 高德地图的优化加载")]),e._v(" "),r("p",[e._v("按照标准的方式，在head里加入高德script，会有什么问题呢？\n问题："),r("br"),e._v("\n1，h5页面反复跳转或返回，高德地图多次加载"),r("br"),e._v("\n2，高德地图的响应不稳定。慢的时候会阻塞整个页面的渲染。"),r("br"),e._v("\n因为高德地图在首页，我们想尽快的给用户显示内容，以避免客户流失。"),r("br"),e._v("\n方案如下："),r("br"),e._v("\n1，preload高德地图js"),r("br"),e._v("\n2，在使用的时候，通过createElement+appendChild的方法，进行懒加载。"),r("br"),e._v("\n3，缓存高德地图对象，再次进入页面如果存在地图对象，不进行2的操作"),r("br"),e._v("\n最终效果：客户会先看到头部和底部内容，高德地图慢慢显示。体验有所提高")]),e._v(" "),r("h3",{attrs:{id:"webview间sessionstorage数据不共享"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#webview间sessionstorage数据不共享"}},[e._v("#")]),e._v(" webview间sessionStorage数据不共享")]),e._v(" "),r("p",[e._v("这个问题的痛点不在于如何解决。方案可以用cookie或localstoreage来替代。"),r("br"),e._v("\n重点是不知道！不知道！不知道！")])])}),[],!1,null,null,null);t.default=s.exports}}]);